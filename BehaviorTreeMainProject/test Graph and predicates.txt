// Test Neo4j connection and predicate creation
Console.WriteLine("\nTesting Neo4j connection...");
try 
{
    var blackboard = new Blackboard<FastName>(
        "bolt://localhost:7687", 
        "neo4j",  // username
        "asd24819zxc"   // default password
    );

    // First predicate (AtLocation)
    var predicateFactory = PredicateFactory.Instance;
    var parameters = new Dictionary<string, Type>
    {
        { "agent", typeof(Agent) },
        { "location", typeof(Location) }
    };
    predicateFactory.DefinePredicateType("AtLocation", parameters);

    // Create and add first predicate
    var r1 = new Agent("r1");
    var loc1 = new CurrentPosition("loc1");
    var values = new Dictionary<string, object>
    {
        { "agent", r1 },
        { "location", loc1 }
    };
    var atLocationPredicate = predicateFactory.CreatePredicateInstance("AtLocation", values);
    await blackboard.AddPredicateWithGraph(new FastName("r1"), atLocationPredicate);
    Console.WriteLine("Successfully added AtLocation predicate to Neo4j");

    // Second predicate (ObjectAtLocation)
    Console.WriteLine("\nCreating ObjectAtLocation predicate...");
    var objectAtLocationParams = new Dictionary<string, Type>
    {
        { "object", typeof(Element) },
        { "location", typeof(Location) }
    };
    predicateFactory.DefinePredicateType("ObjectAtLocation", objectAtLocationParams);
    Console.WriteLine("Defined ObjectAtLocation predicate type");

    var b1 = new Beam("b1");
    blackboard.SetElement(b1.NameKey, b1);
    var values1 = new Dictionary<string, object>
    {
        { "object", b1 },
        { "location", loc1 }
    };
    var objectAtLocationPredicate = predicateFactory.CreatePredicateInstance("ObjectAtLocation", values1);
    Console.WriteLine("Created ObjectAtLocation predicate instance");

    await blackboard.AddPredicateWithGraph(b1.NameKey, objectAtLocationPredicate);
    Console.WriteLine("Successfully added ObjectAtLocation predicate to Neo4j");
}
catch (Exception ex)
{
    Console.WriteLine($"Failed to create or add predicate: {ex.Message}");
    Console.WriteLine($"Stack trace: {ex.StackTrace}");
}